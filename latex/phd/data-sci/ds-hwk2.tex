\input{../preamble.tex}

\usepackage{capt-of}
\usepackage{tikz}
\usetikzlibrary{positioning,calc,intersections,through,backgrounds, shapes.geometric, decorations.markings,arrows}

\def\sset{\subseteq}
\def\iso{\cong}
\def\gend#1{\langle #1\rangle}

\newcommand{\rightoverleftarrow}{%
  \mathrel{\vcenter{\mathsurround0pt
    \ialign{##\crcr
      \noalign{\nointerlineskip}$\longrightarrow$\crcr
      \noalign{\nointerlineskip}$\longleftarrow$\crcr
    }%
  }}%
}

\newcommand\makesphere{} % just for safety
\def\makesphere(#1)(#2)[#3][#4]{%
  % Synopsis
  % \makesphere[draw options](center)(initial angle:final angle:radius)
  \shade[ball color = #3, opacity = #4] #1 circle (#2);
  \draw #1 circle (#2);
  \draw ($#1 - (#2, 0)$) arc (180:360:#2 and 3*#2/10);
  \draw[dashed] ($#1 + (#2, 0)$) arc (0:180:#2 and 3*#2/10);
}
% same thing as makesphere but places white background behind
\newcommand\altmakesphere{} % just for safety
\def\altmakesphere(#1)(#2)(#3)[#4][#5]{%
  % Synopsis
  % \make sphere[draw options](center)(initial angle:final angle:radius)
  \draw [fill=white!30] #1 circle (#2);
  \shade[ball color = #4, opacity = #5] #1 circle (#2);
  \draw #1 circle (#2);
  \draw ($#1 - (#2, 0)$) arc (180:360:#2 and 3*#2/10);
  \draw[dashed] ($#1 + (#2, 0)$) arc (0:180:#2 and 3*#2/10);
  \node at #1 {#3};
}

\begin{document}
% set section number to 1
% fixes theorem numbering without need to have a section title
\setcounter{section}{1}

\pagestyle{empty}
	\LARGE
\begin{center}
	Foundations of Data Science and Machine Learning -- \emph{Homework 2}\\
	\Large
	Isaac Martin \\
    Last compiled \today
\end{center}
\normalsize
\vspace{-4mm}
\hru

\begin{homework}[e]
  \prob 
  \prob$ $
  \begin{enumerate}[(a)]
    \item Fix $\bfx, \bfy \in \bR^d$ both with an $\ell_2$-norm of 1. Suppose that $\Phi:\bR^d\to \bR^r$ is a linear map satisfying
      \begin{equation}\label{eqn:2.1}
        (1  - \epsilon)\|\bfx + \bfy\|_2^2 \leq \|\Phi(\bfx + \bfy)\|^2_2 \leq (1+\epsilon)\|\bfx + \bfy\|^2_2
      \end{equation}
      and
      \begin{equation}\label{eqn:2.2}
        (1  - \epsilon)\|\bfx - \bfy\|_2^2 \leq \|\Phi(\bfx - \bfy)\|^2_2 \leq (1-\epsilon)\|\bfx + \bfy\|^2_2.
      \end{equation}
      Use the identity $4\langle \bfu, \bfv \rangle = \|\bfu + \bfv\|^2_2 - \|u-\bfv\|^2_2$ to show that
      \begin{align*}
        |\langle x,y \rangle - \langle \Phi(x),\Phi(y) \rangle \leq \epsilon\|\bfx\|_2\|y\|_2.
      \end{align*}
    \item If $\chi = \{\bfx_1,...,\bfx_n\}$ is an arbitrary fixed set in $\bR^d$ and $\Phi:\bR^d \to \bR^r$ is a random matrix with independent mean-zero variance $1/r$ Gaussian entries, how should the embedding dimension $r$ scale in terms of $n$, $d$, $\epsilon$ so that with probability at least $0.9$ it holds
      \begin{align*}
        |\langle \bfx_j,\bfx_k \rangle - \langle \Phi(\bfx_j),\Phi(\bfx_k) \rangle| \leq \epsilon \|\bfx\|_2\|\bfy\|_2.
      \end{align*}
  \end{enumerate}
  \begin{prf}
    \begin{enumerate}[(a)]
      \item Rearrange both equation (\ref{eqn:2.1}) and (\ref{eqn:2.2}) as follows:
        \begin{equation}\label{eqn:2.3}
          -\epsilon\|\bfx +\bfy\|_2^2 \leq \|\Phi(\bfx + \bfy)\|_2^2 - \|\bfx + \bfy\|_2^2 \leq \epsilon\|\bfx + \bfy\|^2_2
        \end{equation}
        \begin{equation}\label{eqn:2.4}
          -\epsilon\|\bfx -\bfy\|_2^2 \leq \|\Phi(\bfx - \bfy)\|_2^2 - \|\bfx - \bfy\|_2^2 \leq \epsilon\|\bfx - \bfy\|^2_2.
        \end{equation}
        Since $\|\bfx\|_2,\|\bfy\|_2\leq 1$, by the triangle inequality $\|\bfx - \bfy\|_2^2, \|\bfx + \bfy\|_2^2 \leq 1$. Using this fact and adding equation (\ref{eqn:2.4}) to the negative of (\ref{eqn:2.3}) yields
        \begin{align*}
          -4\epsilon \leq \|\bfx + \bfy\|^2_2 - \|\bfx - \bfy\|_2^2 - (\|\Phi(x + y)\|^2_2 - \|\Phi(x - y)\|^2_2)\leq 4\epsilon.
        \end{align*}
        Linearity of $\Phi$ together with the given identity then implies
        \begin{align*}
          -4 \epsilon \leq 4\langle \bfx,\bfy \rangle - 4\langle \Phi(\bfx),\Phi(\bfy) \rangle \leq 4\epsilon,
        \end{align*}
        and so we have
        \begin{align*}
          \big|\langle \bfx,\bfy \rangle - \langle \Phi(\bfx),\Phi(\bfy) \rangle\big| \leq \epsilon = \epsilon\|\bfx\|_2\|\bfy\|_2
        \end{align*}
        as desired.
      \item 
    \end{enumerate}
  \end{prf}
\end{homework}
\end{document}
